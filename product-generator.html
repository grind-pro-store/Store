<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GRIND PRO - G√©n√©rateur de produit</title>
<link href="css/style.css" rel="stylesheet" />
<style>
.generator {
  max-width: 700px;
  margin: 30px auto;
  background: #fff;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.06);
}
textarea, input {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
}
label {
  font-weight: 600;
}
button {
  background: var(--accent);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 12px 18px;
  cursor: pointer;
  font-weight: 600;
}
#output {
  margin-top: 24px;
  white-space: pre-wrap;
  background: #fafafa;
  border: 1px solid #e6e6e6;
  padding: 16px;
  border-radius: 10px;
  overflow-x: auto;
}
</style>
</head>
<body class="container">
<header class="site-header">
  <div class="site-title">
    <img src="https://raw.githubusercontent.com/grind-pro-store/site/main/logo.png" alt="Logo"/>
    <span>GRIND PRO</span>
  </div>
</header>

<main>
  <h1>G√©n√©rateur de page produit</h1>
  <p>Remplissez les informations ci-dessous pour g√©n√©rer automatiquement le code HTML d‚Äôun nouveau produit.</p>

  <div class="generator">
    <label>Nom du produit</label>
    <input id="pName" placeholder="Ex: Demi veste" />

    <label>Prix</label>
    <input id="pPrice" placeholder="Ex: 1400" />

    <label>Prix r√©duit (optionnel)</label>
    <input id="pReduced" placeholder="Ex: 1200 (laisser vide si aucun)" />

    <label>Tailles disponibles (s√©par√©es par des virgules)</label>
    <input id="pSizes" placeholder="Ex: S,M,L" />

    <label>Couleurs (nom=imageURL) ‚Äì une par ligne</label>
    <textarea id="pColors" rows="4" placeholder="Ex:
Noire=https://example.com/noir.jpg
Blanc=https://example.com/blanc.jpg"></textarea>

    <button type="button" onclick="generateHTML()">G√©n√©rer le code HTML</button>

    <div id="output"></div>
  </div>
</main>

<footer class="footer">¬© GRIND PRO</footer>

<script>
function generateHTML() {
  const name = document.getElementById("pName").value.trim();
  const price = document.getElementById("pPrice").value.trim();
  const reduced = document.getElementById("pReduced").value.trim();
  const sizes = document.getElementById("pSizes").value.split(",").map(s => s.trim()).filter(Boolean);
  const colorsInput = document.getElementById("pColors").value.trim().split("\\n").filter(Boolean);

  if (!name || !price || colorsInput.length === 0) {
    alert("Veuillez remplir le nom, le prix et au moins une couleur !");
    return;
  }

  let colorButtons = "";
  let thumbs = "";
  let firstImg = "";
  colorsInput.forEach((line, i) => {
    if (!line.includes("=")) return;
    const [cName, cUrl] = line.split("=");
    if (i === 0) firstImg = cUrl;
    colorButtons += `<button class="option-button${i===0?" active":""}" data-color="${cName}" data-group="color-${name.replace(/\\s+/g,"_")}" data-src="${cUrl}">${cName}</button>`;
    thumbs += `<img class="thumb${i===0?" active":""}" data-src="${cUrl}" src="${cUrl}"/>`;
  });

  let sizeButtons = "";
  sizes.forEach((sz, i) => {
    const active = i === 0 ? " active" : "";
    sizeButtons += `<button class="option-button${active}" data-size="${sz}">${sz}</button>`;
  });

  const priceRow = reduced
    ? `<div class="price-row"><div class="current-price">${reduced} DA</div><div class="orig-price">${price} DA</div></div>`
    : `<div class="price-row"><div class="current-price">${price} DA</div></div>`;

  const outputHTML = `<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>${name}</title>
<link href="css/style.css" rel="stylesheet"/>
</head>
<body>
<header class="site-header container">
  <div class="site-title"><img src="https://raw.githubusercontent.com/grind-pro-store/site/main/logo.png" alt="GRIND PRO logo"/><span>GRIND PRO</span></div>
  <nav class="site-nav"><a href="index.html">Home</a><a href="contact.html">Contact</a></nav>
  <div><a href="cart.html"><button class="icon-btn">üõí <span id="cart-count" style="font-size:12px">0</span></button></a></div>
</header>

<main class="container">
<section class="product-page" data-price="${price}" data-product="${name.replace(/\\s+/g,"_").toLowerCase()}">
  <div class="product-gallery">
    <img alt="${name}" class="main-image" id="mainImg" src="${firstImg}"/>
    <div class="thumbs">${thumbs}</div>
  </div>

  <aside class="product-info">
    <div class="product-vendor">GRIND PRO</div>
    <h1 class="product-title">${name}</h1>
    ${priceRow}
    <div style="margin-top:12px"><strong>Couleur:</strong>
      <div class="size-row" style="margin-top:8px">${colorButtons}</div>
    </div>
    <div style="margin-top:12px"><strong>Taille:</strong>
      <div class="size-row">${sizeButtons}</div>
    </div>
    <div class="btn-row">
      <button class="btn-action btn-primary" onclick="handleAddToCart(this)">Ajouter au panier</button>
      <button class="btn-action btn-cardlist" onclick="window.location.href='cart.html'">Liste de souhaits</button>
      <button class="btn-action btn-secondary btn-buy">Acheter</button>
    </div>
    <div class="product-tabs" style="margin-top:16px">
      <div class="tab"><strong>D√©tails:</strong> Produit ${name}, tailles disponibles: ${sizes.join(", ")}.</div>
      <div class="tab"><strong>Livraison:</strong> Exp√©dition sous 1-3 jours ouvrables.</div>
    </div>
  </aside>
</section>
</main>

<footer class="footer">¬© GRIND PRO</footer>
<script src="js/main.js"></script>
<script src="js/purchase.js"></script>
</body>
</html>`;

  // Display preview
  document.getElementById("output").textContent = outputHTML;

  // Try to trigger download
  try {
    const blob = new Blob([outputHTML], { type: "text/html" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = name.replace(/\\s+/g, "_").toLowerCase() + ".html";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  } catch (err) {
    alert("Le t√©l√©chargement automatique a √©t√© bloqu√© ‚Äî copiez le code manuellement depuis l'aper√ßu.");
  }
}
</script>
</body>
</html>
